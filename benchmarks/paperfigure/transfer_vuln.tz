parameter (pair address mutez);
storage (pair (map address mutez) mutez);
code { 
  UNPAIR; UNPAIR; DIP 2 { UNPAIR };
  DUP 3; DUP 2; GET; IF_NONE { PUSH mutez 0 } {};
  DUP 4; SENDER; GET; IF_NONE { FAIL } {};
  DUP 4; DUP 2; COMPARE; GE; IF {} { FAIL };
  DIP { DIG 3 ; SENDER ; DUP 5 }; SUB; SOME; SWAP; UPDATE;
  DUG 3; DIP { SWAP }; ADD; SOME; SWAP; UPDATE;
  PAIR; NIL operation; PAIR }